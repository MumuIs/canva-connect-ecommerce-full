# Brand Template å®Œæ•´æµç¨‹è¯´æ˜

## ğŸ”„ å®Œæ•´æµç¨‹è§£æ

### 1. åˆå§‹çŠ¶æ€
- ç”¨æˆ·è®¿é—® Brand Template Creator é¡µé¢
- ç³»ç»ŸåŠ è½½ç”¨æˆ·çš„å“ç‰Œæ¨¡æ¿åˆ—è¡¨
- ç”¨æˆ·é€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ªæ¨¡æ¿

### 2. åˆ›å»ºè¿‡ç¨‹
```
ç”¨æˆ·ç‚¹å‡»"åˆ›å»ºè®¾è®¡å‰¯æœ¬"
    â†“
ç³»ç»Ÿæ„å»ºå¸¦æœ‰ return navigation çš„ URLï¼š
https://www.canva.cn/design?create=true&template=EAGsBIYXsh8&return_nav_url=...&correlation_state=...
    â†“
æ‰“å¼€æ–°çš„ Canva ç¼–è¾‘å™¨çª—å£
    â†“
Canva åˆ›å»ºæ–°çš„è®¾è®¡å‰¯æœ¬ï¼ˆåŸºäºæ¨¡æ¿ï¼‰
    â†“
ç”¨æˆ·è·å¾—æ–°çš„è®¾è®¡ IDï¼ˆå¦‚ï¼šDAG0QACYBWYï¼‰
    â†“
ç”¨æˆ·ç¼–è¾‘è®¾è®¡
```

### 3. è¿”å›è¿‡ç¨‹
```
ç”¨æˆ·å®Œæˆç¼–è¾‘ï¼Œç‚¹å‡»"è¿”å›"æŒ‰é’®
    â†“
Canva é‡å®šå‘åˆ°ï¼šhttp://127.0.0.1:3001/return-nav?correlation_jwt=...
    â†“
åç«¯éªŒè¯ JWT å¹¶è§£æè®¾è®¡ ID
    â†“
å‰ç«¯è·å–æ–°åˆ›å»ºçš„è®¾è®¡è¯¦æƒ…
    â†“
æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯å’Œè®¾è®¡ä¿¡æ¯
```

## ğŸ¯ å…³é”®ç†è§£ç‚¹

### âœ… æ­£å¸¸è¡Œä¸º
1. **Brand Template â†’ æ–°è®¾è®¡**ï¼šè¿™æ˜¯é¢„æœŸçš„è¡Œä¸º
2. **æ–°è®¾è®¡æœ‰æ–°çš„ ID**ï¼šæ¯ä¸ªå‰¯æœ¬éƒ½æ˜¯ç‹¬ç«‹çš„è®¾è®¡
3. **Return Navigation ä»ç„¶æœ‰æ•ˆ**ï¼šä¼šè¿”å›æ–°åˆ›å»ºçš„è®¾è®¡ä¿¡æ¯

### ğŸ” URL å˜åŒ–è¯´æ˜
```
åŸå§‹æ¨¡æ¿ URLï¼š
https://www.canva.cn/design?create=true&template=EAGsBIYXsh8

åˆ›å»ºåçš„æ–°è®¾è®¡ URLï¼š
https://www.canva.cn/design/DAG0QACYBWY/nRdDBzq5ZZRX0-pdvv5Ezw/edit

è¿™æ˜¯æ­£å¸¸çš„ï¼æ–°è®¾è®¡æœ‰è‡ªå·±çš„ ID å’Œç¼–è¾‘ URLã€‚
```

## ğŸ“‹ å®é™…æµ‹è¯•æ­¥éª¤

### 1. å‡†å¤‡æµ‹è¯•
```bash
# ç¡®ä¿åº”ç”¨è¿è¡Œ
npm run demo:ecommerce

# è®¿é—®é¡µé¢
http://127.0.0.1:3000/brand-template-creator
```

### 2. æ‰§è¡Œæµ‹è¯•
1. **è¿æ¥ Canva**ï¼šç‚¹å‡» "Connect to Canva" è¿›è¡Œæˆæƒ
2. **é€‰æ‹©æ¨¡æ¿**ï¼šé€‰æ‹©ä¸€ä¸ªå“ç‰Œæ¨¡æ¿
3. **åˆ›å»ºå‰¯æœ¬**ï¼šç‚¹å‡» "åˆ›å»ºè®¾è®¡å‰¯æœ¬"
4. **è§‚å¯Ÿ URL**ï¼šæ³¨æ„ URL ä»æ¨¡æ¿ URL å˜ä¸ºæ–°è®¾è®¡ URL
5. **ç¼–è¾‘è®¾è®¡**ï¼šåœ¨ Canva ä¸­è¿›è¡Œä¸€äº›ç¼–è¾‘
6. **ç‚¹å‡»è¿”å›**ï¼šåœ¨ Canva ä¸­ç‚¹å‡»è¿”å›æŒ‰é’®
7. **éªŒè¯è¿”å›**ï¼šç¡®è®¤è¿”å›åˆ°åº”ç”¨å¹¶æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯

### 3. é¢„æœŸç»“æœ
- âœ… æˆåŠŸåˆ›å»ºæ–°è®¾è®¡å‰¯æœ¬
- âœ… æ–°è®¾è®¡æœ‰ç‹¬ç«‹çš„ ID
- âœ… Return Navigation æ­£å¸¸å·¥ä½œ
- âœ… åº”ç”¨æ˜¾ç¤ºè®¾è®¡è¯¦æƒ…

## ğŸ› ï¸ é«˜çº§åŠŸèƒ½æ‰©å±•

### 1. è®¾è®¡å†å²è®°å½•
```typescript
// ä¿å­˜åˆ›å»ºçš„è®¾è®¡å†å²
const saveDesignHistory = (designDetails: DesignDetails) => {
  const history = JSON.parse(localStorage.getItem('designHistory') || '[]');
  history.push(designDetails);
  localStorage.setItem('designHistory', JSON.stringify(history));
};
```

### 2. æ‰¹é‡è®¾è®¡ç®¡ç†
```typescript
// ç®¡ç†å¤šä¸ªåˆ›å»ºçš„è®¾è®¡
const [createdDesigns, setCreatedDesigns] = useState<DesignDetails[]>([]);

const handleDesignCreated = (design: DesignDetails) => {
  setCreatedDesigns(prev => [...prev, design]);
};
```

### 3. è®¾è®¡çŠ¶æ€è·Ÿè¸ª
```typescript
// è·Ÿè¸ªè®¾è®¡çŠ¶æ€
type DesignStatus = 'created' | 'editing' | 'completed' | 'exported';

const trackDesignStatus = (designId: string, status: DesignStatus) => {
  // æ›´æ–°è®¾è®¡çŠ¶æ€
};
```

## ğŸ”§ æ•…éšœæ’é™¤

### é—®é¢˜ï¼šReturn Navigation ä¸å·¥ä½œ
**å¯èƒ½åŸå› ï¼š**
1. URL ä¸­æ²¡æœ‰ `return_nav_url` å‚æ•°
2. Developer Portal ä¸­æœªå¯ç”¨ Return Navigation
3. JWT éªŒè¯å¤±è´¥

**è§£å†³æ–¹æ¡ˆï¼š**
```typescript
// æ£€æŸ¥ URL æ ¼å¼
const url = new URL(createUrl);
console.log('Return nav URL:', url.searchParams.get('return_nav_url'));
console.log('Correlation state:', url.searchParams.get('correlation_state'));
```

### é—®é¢˜ï¼šè®¾è®¡ ID ä¸åŒ¹é…
**è¯´æ˜ï¼š** è¿™æ˜¯æ­£å¸¸è¡Œä¸ºï¼Brand Template åˆ›å»ºçš„æ˜¯æ–°è®¾è®¡ï¼Œä¼šæœ‰æ–°çš„ IDã€‚

**éªŒè¯æ–¹æ³•ï¼š**
```typescript
// åœ¨ return navigation ä¸­éªŒè¯
const returnedDesignId = parsedJwt.design_id; // è¿™æ˜¯æ–°åˆ›å»ºçš„è®¾è®¡ ID
const originalTemplateId = correlationState.selectedTemplates[0]; // è¿™æ˜¯åŸå§‹æ¨¡æ¿ ID

console.log('åŸå§‹æ¨¡æ¿ ID:', originalTemplateId);
console.log('æ–°åˆ›å»ºçš„è®¾è®¡ ID:', returnedDesignId);
// è¿™ä¸¤ä¸ª ID ä¸åŒæ˜¯æ­£å¸¸çš„ï¼
```

## ğŸ“Š å®Œæ•´çš„æ•°æ®æµ

```mermaid
graph TD
    A[ç”¨æˆ·é€‰æ‹©æ¨¡æ¿] --> B[æ„å»º create URL]
    B --> C[æ·»åŠ  return_nav_url å‚æ•°]
    C --> D[æ·»åŠ  correlation_state å‚æ•°]
    D --> E[æ‰“å¼€ Canva ç¼–è¾‘å™¨]
    E --> F[Canva åˆ›å»ºæ–°è®¾è®¡å‰¯æœ¬]
    F --> G[ç”¨æˆ·ç¼–è¾‘è®¾è®¡]
    G --> H[ç”¨æˆ·ç‚¹å‡»è¿”å›]
    H --> I[JWT éªŒè¯]
    I --> J[è§£ææ–°è®¾è®¡ ID]
    J --> K[è·å–è®¾è®¡è¯¦æƒ…]
    K --> L[æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯]
```

## ğŸ‰ æ€»ç»“

Brand Template API çš„å·¥ä½œæµç¨‹æ˜¯ï¼š
1. **æ¨¡æ¿** â†’ **æ–°è®¾è®¡å‰¯æœ¬**ï¼ˆæ­£å¸¸è¡Œä¸ºï¼‰
2. **æ–°è®¾è®¡** æœ‰è‡ªå·±çš„ ID å’Œ URLï¼ˆé¢„æœŸç»“æœï¼‰
3. **Return Navigation** è¿”å›æ–°è®¾è®¡çš„ä¿¡æ¯ï¼ˆåŠŸèƒ½æ­£å¸¸ï¼‰

è¿™ä¸ªæµç¨‹å®Œå…¨ç¬¦åˆ Canva API çš„è®¾è®¡ç†å¿µï¼Œæ¯ä¸ªæ¨¡æ¿å‰¯æœ¬éƒ½æ˜¯ç‹¬ç«‹çš„è®¾è®¡ï¼Œå¯ä»¥å•ç‹¬ç®¡ç†å’Œç¼–è¾‘ã€‚
